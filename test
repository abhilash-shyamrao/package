import { render, screen, fireEvent } from '@testing-library/react';
import ReportingGroup from './ReportingGroup'; // Ensure the correct path to your component
import { vi } from 'vitest';

// Mock MetadataService to avoid actual API calls
vi.mock('../../services/MetadataService', () => ({
  getLobs: vi.fn(() => Promise.resolve(['LOB1', 'LOB2'])),
  getRegions: vi.fn(() => Promise.resolve(['Region1', 'Region2'])),
}));

describe('ReportingGroup Component', () => {
  it('should update form values on input change', () => {
    render(<ReportingGroup />);

    // Simulate typing in the name input (casting to HTMLInputElement)
    const nameInput = screen.getByLabelText(/Name/i);
    fireEvent.blur(nameInput, { target: { value: 'Test Group' } as HTMLInputElement });
    expect((nameInput as HTMLInputElement).value).toBe('Test Group');

    // Simulate selecting Line of Business (casting to HTMLSelectElement)
    const lobSelect = screen.getByLabelText(/Line of Business/i);
    fireEvent.change(lobSelect, { target: { value: 'LOB1' } as HTMLSelectElement });
    expect((lobSelect as HTMLSelectElement).value).toBe('LOB1');

    // Simulate selecting Region (casting to HTMLSelectElement)
    const regionSelect = screen.getByLabelText(/Region/i);
    fireEvent.change(regionSelect, { target: { value: 'Region1' } as HTMLSelectElement });
    expect((regionSelect as HTMLSelectElement).value).toBe('Region1');

    // Simulate typing in the email list input (casting to HTMLInputElement)
    const emailInput = screen.getByLabelText(/Email List/i);
    fireEvent.blur(emailInput, { target: { value: 'test@example.com' } as HTMLInputElement });
    expect((emailInput as HTMLInputElement).value).toBe('test@example.com');
  });
});
