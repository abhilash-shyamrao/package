CREATE VIEW dq_results_full_join_view AS
SELECT
    COALESCE(master.dq_result_id, analyzer.dq_result_id, observation.dq_result_id, rule.dq_result_id) AS dq_result_id,
    master.job_run_id,
    master.job_start_time,
    master.job_end_time,
    master.dq_config_name,
    master.dq_rule_id_list,
    master.reporting_group_id_list,
    master.runtime_config,
    master.execution_region,
    master.error_category,
    master.error_message,
    master.score,
    analyzer.analyzer_result_item_id,
    analyzer.analyzer_name,
    analyzer.analyzer_definition,
    analyzer.analyzer_evaluated_metrics,
    analyzer.created_by AS analyzer_created_by,
    analyzer.created_on AS analyzer_created_on,
    observation.observation_item_id,
    observation.observation_description,
    observation.observation_metric_name,
    observation.observation_static_id,
    observation.observation_metric_expected_value,
    observation.observation_metric_actual_value,
    observation.observation_metric_lower_limit,
    observation.observation_metric_upper_limit,
    observation.observation_new_rules,
    observation.created_by AS observation_created_by,
    observation.created_on AS observation_created_on,
    rule.result_item_id,
    rule.rule_name,
    rule.rule_definition,
    rule.rule_evaluation_message,
    rule.result_status,
    rule.evaluation_metrics,
    rule.evaluated_rule,
    rule.created_by AS rule_created_by,
    rule.created_on AS rule_created_on
FROM 
    dq_results_master master
FULL OUTER JOIN dq_results_analyzer_details analyzer
    ON master.dq_result_id = analyzer.dq_result_id
FULL OUTER JOIN dq_results_observation_details observation
    ON master.dq_result_id = observation.dq_result_id
FULL OUTER JOIN dq_results_rule_details rule
    ON master.dq_result_id = rule.dq_result_id;
